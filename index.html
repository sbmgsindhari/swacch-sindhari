<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Swacch Sindhari Monitoring</title>
  <style>
    body { font-family: Arial; padding: 20px; max-width: 600px; margin: auto; }
    input, select, textarea, button { width: 100%; padding: 10px; margin: 10px 0; }
    img { max-height: 200px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>स्वच्छता कार्य दर्ज करें</h2>
  
  <form id="sanitationForm">
    <label>दिनांक:</label>
    <input type="date" name="date" required>

    <label>पंचायत:</label>
    <select name="panchayatName" required>
      <option value="">--चुनें--</option>
      <option>होडू</option>
      <option>बामणी</option>
      <option>भाटा</option>
      <!-- और जोड़ सकते हैं -->
    </select>

    <label>कार्य प्रकार:</label>
    <select name="workType" required>
      <option value="">--चुनें--</option>
      <option>घर-घर कचरा संग्रहण</option>
      <option>नाली सफाई</option>
      <option>सड़क सफाई</option>
      <option>सामुदायिक स्वच्छता परिसर</option>
    </select>

    <label>टिप्पणी:</label>
    <textarea name="remarks" rows="3"></textarea>

    <label>फोटो चुनें:</label>
    <input type="file" id="imageInput" accept="image/*" required>
    <img id="preview" src="#" alt="Image Preview" style="display:none;"/>

    <button type="submit">सबमिट करें</button>
  </form>

  <div id="message"></div>

  <script>
    const form = document.getElementById('sanitationForm');
    const preview = document.getElementById('preview');
    let base64Image = "", photoType = "";

    document.getElementById('imageInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onloadend = function () {
        base64Image = reader.result.split(',')[1];
        photoType = file.type;
        preview.src = reader.result;
        preview.style.display = "block";
      };
      reader.readAsDataURL(file);
    });

    form.addEventListener('submit', async function(event) {
      event.preventDefault();

      const formData = new FormData(form);
      const data = {
        date: formData.get('date'),
        panchayatName: formData.get('panchayatName'),
        workType: formData.get('workType'),
        remarks: formData.get('remarks'),
        photoBase64: base64Image,
        photoType: photoType
      };

      document.getElementById('message').innerText = 'Uploading...';

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbyqV-LzXpGmKKxNZoQQjGB2-oCu2IMdSEpuIR78Ji-VkStM5r6nxm0jMhd78hznOS0PWw/exec", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const text = await response.text();
        document.getElementById('message').innerText = text.includes("Success") ? "✅ सफलतापूर्वक भेजा गया!" : "❌ विफलता: " + text;
      } catch (err) {
        document.getElementById('message').innerText = "❌ Error: " + err;
      }
    });
  </script>
</body>
</html>
